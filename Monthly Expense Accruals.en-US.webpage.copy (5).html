<!-- Monthly Expense Accruals - Enterprise UI -->
<div class="ea-page">

  <!-- Page Header -->
  <header class="ea-header">
    <div class="ea-header-content">
      <h1 class="ea-header-title">
        <span class="ea-title-icon"><i class="fas fa-chart-bar"></i></span>
        Monthly Expense Accruals
      </h1>
      <p class="ea-header-subtitle">Track and manage expense accruals across all DCLs with dual-view reporting and AED-converted exports.</p>
    </div>
    <div class="ea-header-actions">
      <button onclick="exportToExcel()" class="ea-btn ea-btn--success">
        <i class="fas fa-download"></i> Export to Excel (AED)
      </button>
    </div>
  </header>

  <!-- Report Tab Switcher -->
  <div class="ea-tabs">
    <button class="ea-tab report-tab active" data-report="summary">
      <i class="fas fa-table"></i> Summary Accruals
    </button>
    <button class="ea-tab report-tab" data-report="expense">
      <i class="fas fa-file-invoice-dollar"></i> Expense Accruals
    </button>
  </div>

  <!-- Filters -->
  <div class="ea-filters">
    <div class="ea-filters-header" onclick="this.parentElement.querySelector('.ea-filters-body').classList.toggle('hidden')">
      <div class="ea-filters-title">
        <i class="fas fa-sliders-h"></i> Filters &amp; Search
      </div>
      <div class="ea-filters-toggle">
        <i class="fas fa-chevron-down"></i>
      </div>
    </div>
    <div class="ea-filters-body">
      <!-- Search -->
      <div class="ea-search filter-group">
        <i class="fas fa-search ea-search-icon"></i>
        <input type="search" id="searchInput" class="ea-search-input" placeholder="Search by DCL #, Customer PO, Customer Name, Export Executive, BL #..." />
      </div>

      <!-- Filter Grid -->
      <div class="ea-filter-grid">
        <div class="ea-field filter-group">
          <label for="filterStatus" class="ea-field-label"><i class="fas fa-circle"></i> Status</label>
          <select id="filterStatus" class="ea-select">
            <option value="">All Statuses</option>
          </select>
        </div>
        <div class="ea-field filter-group">
          <label for="filterExportExec" class="ea-field-label"><i class="fas fa-user"></i> Export Executive</label>
          <select id="filterExportExec" class="ea-select">
            <option value="">All Executives</option>
          </select>
        </div>
        <div class="ea-field filter-group">
          <label for="filterMonth" class="ea-field-label"><i class="fas fa-calendar"></i> Month</label>
          <select id="filterMonth" class="ea-select">
            <option value="">All Months</option>
            <option value="1">January</option>
            <option value="2">February</option>
            <option value="3">March</option>
            <option value="4">April</option>
            <option value="5">May</option>
            <option value="6">June</option>
            <option value="7">July</option>
            <option value="8">August</option>
            <option value="9">September</option>
            <option value="10">October</option>
            <option value="11">November</option>
            <option value="12">December</option>
          </select>
        </div>
        <div class="ea-field filter-group">
          <label for="filterYear" class="ea-field-label"><i class="fas fa-calendar-alt"></i> Year</label>
          <select id="filterYear" class="ea-select">
            <option value="">All Years</option>
          </select>
        </div>
        <div class="ea-field filter-group">
          <label for="filterBusinessUnit" class="ea-field-label"><i class="fas fa-building"></i> Business Unit</label>
          <select id="filterBusinessUnit" class="ea-select">
            <option value="">All Business Units</option>
          </select>
        </div>
        <div class="ea-field filter-group">
          <label for="filterCustomer" class="ea-field-label"><i class="fas fa-briefcase"></i> Customer</label>
          <select id="filterCustomer" class="ea-select">
            <option value="">All Customers</option>
          </select>
        </div>
        <div class="ea-field filter-group">
          <label for="filterCountry" class="ea-field-label"><i class="fas fa-globe-americas"></i> Country</label>
          <select id="filterCountry" class="ea-select">
            <option value="">All Countries</option>
          </select>
        </div>
      </div>

      <!-- Actions -->
      <div class="ea-filters-actions">
        <button onclick="resetFilters()" class="ea-btn ea-btn--secondary">
          <i class="fas fa-undo"></i> Reset
        </button>
        <button onclick="applyFilters()" class="ea-btn ea-btn--primary">
          <i class="fas fa-search"></i> Apply Filters
        </button>
      </div>
    </div>
  </div>

  <!-- Statistics -->
  <div class="ea-stats">
    <div class="ea-stat">
      <div class="ea-stat-icon ea-stat-icon--records"><i class="fas fa-layer-group"></i></div>
      <div class="ea-stat-body">
        <div class="ea-stat-label">Total Records</div>
        <div id="statTotalRecords" class="ea-stat-value">0</div>
      </div>
    </div>
    <div class="ea-stat">
      <div class="ea-stat-icon ea-stat-icon--dcls"><i class="fas fa-file-alt"></i></div>
      <div class="ea-stat-body">
        <div class="ea-stat-label">Unique DCLs</div>
        <div id="statTotalDCLs" class="ea-stat-value">0</div>
      </div>
    </div>
    <div class="ea-stat">
      <div class="ea-stat-icon ea-stat-icon--qty"><i class="fas fa-weight-hanging"></i></div>
      <div class="ea-stat-body">
        <div class="ea-stat-label">Total Qty (MT)</div>
        <div id="statTotalQtyMT" class="ea-stat-value">0</div>
      </div>
    </div>
    <div class="ea-stat">
      <div class="ea-stat-icon ea-stat-icon--customers"><i class="fas fa-users"></i></div>
      <div class="ea-stat-body">
        <div class="ea-stat-label">Unique Customers</div>
        <div id="statCustomers" class="ea-stat-value">0</div>
      </div>
    </div>
  </div>

  <!-- Data Table -->
  <div class="ea-table-section">
    <div class="ea-table-toolbar">
      <h2 id="tableTitle" class="ea-table-title">
        <i class="fas fa-table"></i> Summary Accruals Report
      </h2>
      <span id="recordCount" class="ea-record-count">0 records</span>
    </div>

    <div class="ea-table-wrap table-container">
      <table id="expenseTable" class="ea-table data-table">
        <thead>
          <tr>
            <!-- Headers populated by JavaScript -->
          </tr>
        </thead>
        <tbody id="tableBody">
          <tr>
            <td colspan="100%">
              <div class="empty-state">
                <i class="fas fa-spinner fa-pulse"></i>
                <h3>Loading Data...</h3>
                <p>Fetching expense accruals from all data sources</p>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div class="ea-pagination">
      <div class="ea-pagination-btns">
        <button id="firstPage" title="First Page" class="ea-page-btn"><i class="fas fa-angle-double-left"></i></button>
        <button id="prevPage" title="Previous Page" class="ea-page-btn"><i class="fas fa-angle-left"></i></button>
      </div>
      <div class="ea-pagination-info">
        Page <span id="currentPage">1</span> of <span id="totalPages">1</span>
      </div>
      <div class="ea-pagination-btns">
        <button id="nextPage" title="Next Page" class="ea-page-btn"><i class="fas fa-angle-right"></i></button>
        <button id="lastPage" title="Last Page" class="ea-page-btn"><i class="fas fa-angle-double-right"></i></button>
      </div>
    </div>
  </div>

  <!-- User Guide -->
  <details class="ea-guide">
    <summary><i class="fas fa-question-circle"></i> User Guide &amp; Field Definitions</summary>
    <div class="ea-guide-body">
      <h3>Report Views</h3>
      <ul>
        <li><strong>Summary Accruals:</strong> Complete report with all columns including DCL #, CI Number, Status, and full details</li>
        <li><strong>Expense Accruals:</strong> Focused view with 18 key columns for costs and charges analysis</li>
      </ul>

      <h3>How to Use</h3>
      <ul>
        <li><strong>Filter:</strong> Use the dropdowns to narrow records by Status, Executive, Month, Business Unit, Customer, or Country</li>
        <li><strong>Search:</strong> Global search works across DCL #, CI Number, Customer PO, Customer Name, Export Executive, and BL #</li>
        <li><strong>Sort:</strong> Click any column header to sort ascending; click again for descending</li>
        <li><strong>Export:</strong> Click "Export to Excel (AED)" to download all filtered records with currency values converted to AED</li>
      </ul>

      <h3>Currency Conversion (Export)</h3>
      <ul>
        <li><strong>USD:</strong> 3.6725 AED</li>
        <li><strong>SAR:</strong> 0.9793 AED</li>
        <li><strong>EUR:</strong> 4.02 AED</li>
        <li><strong>GBP:</strong> 4.65 AED</li>
      </ul>

      <h3>Column Legend</h3>
      <ul>
        <li><strong>Green values:</strong> Formula-calculated fields (Total Freight, Per Ltr. Cost, Per MT Cost)</li>
        <li><strong>Gray italic:</strong> Missing data (N/A)</li>
        <li>All data is automatically sourced from Dataverse â€” no manual entry required</li>
      </ul>
    </div>
  </details>

</div>

<!-- Loading Overlay -->
<div id="loadingOverlay" class="ea-loading-overlay hidden">
  <div class="ea-loading-card">
    <div class="ea-spinner"></div>
    <div id="loadingText" class="ea-loading-text">Loading...</div>
  </div>
</div>
